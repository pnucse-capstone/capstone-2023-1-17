# NeRFë¥¼ ì´ìš©í•œ ì¤‘ê³ ì‹œì¥ í”Œë«í¼ ê°œë°œ

2023ë…„ ì „ê¸° ì¡¸ì—…ê³¼ì œ 17ì¡° ì—ë“€ìœŒì˜ **NeRFë¥¼ ì´ìš©í•œ ì¤‘ê³ ì‹œì¥ í”Œë«í¼ ê°œë°œ**ì…ë‹ˆë‹¤.

<br>

## 1. í”„ë¡œì íŠ¸ ì†Œê°œ

### ê³¼ì œ ë°°ê²½

- ì¤‘ê³  ê±°ë˜ ì‹œì¥ì´ ì»¤ì§€ë©´ì„œ, 4ë…„ ì „ì— ë¹„í•´ ì¤‘ê³  ê±°ë˜ ë¶„ìŸì˜ ìˆ˜ê°€ 8ë°° ì´ìƒ ì¦ê°€í–ˆë‹¤.
- ì œí’ˆì˜ ì‚¬ì§„ë§Œìœ¼ë¡œ íŒŒì•…í–ˆë˜ ìƒíƒœë¥¼ 3D ëª¨ë¸ì„ í†µí•´ í™•ì¸í•œë‹¤ë©´, ë¶„ìŸì˜ ìˆ˜ë¥¼ ì¤„ì¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

### ê³¼ì œ ëª©í‘œ

- **NeRF**ë¥¼ ì‚¬ìš©í•˜ì—¬ ì œí’ˆì˜ 3D ëª¨ë¸ì„ ARì„ í†µí•´ í™•ì¸í•˜ë„ë¡ í•œë‹¤.
- 3Dë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •ì„ ì„œë²„ë¥¼ í†µí•´ **ìë™í™”**í•œë‹¤.

<br>

## 2. íŒ€ ì†Œê°œ

| ì´ë¦„                                                                                                                                     | ì´ë©”ì¼             | ì—­í•                                                                                                    |
| ---------------------------------------------------------------------------------------------------------------------------------------- | ------------------ | ------------------------------------------------------------------------------------------------------ |
| <img src="https://github.com/aglra3.png" width="100"> <br> <div align="center"> [ì€ìŠ¹ìš°](https://github.com/aglra3) </div>               | aglra3@pusan.ac.kr | - Unity AR Core ê°œë°œ <br>- Mesh ì „ì²˜ë¦¬<br>- Occlusion/íƒìŠ¤ì³ ê°œë°œ                                      |
| <img src="https://github.com/JaesubKwon.png" width="100"> <br> <div align="center">[ê¶Œì¬ì„­](https://github.com/JaesubKwon) </div>        | suba0507@gmail.com | - shell scriptë¥¼ í†µí•œ nerfstudio ìë™í™” <br>- spring bootë¥¼ ì‚¬ìš©í•´ ì„œë²„ ê°œë°œ <br>- ì„œë²„ì— MariaDB ì—°ë™ |
| <img src="https://github.com/SeonghyeonKim.png" width="100"> <br> <div align="center"> [ê¹€ì„±í˜„](https://github.com/SeonghyeonKim) </div> | kkgojn@gmail.com   | - ì•ˆë“œë¡œì´ë“œ í”„ëŸ°íŠ¸ ê°œë°œ <br>- ì•ˆë“œë¡œì´ë“œ/ìœ ë‹ˆí‹° ì—°ë™ <br>- ì…ë ¥ ë°ì´í„° ê´€ë¦¬                           |

<br>

## 3. êµ¬ì„±ë„

### êµ¬ì¡°

![êµ¬ì¡°_ë‹¨ìˆœí™”](https://github.com/pnucse-capstone/capstone-2023-1-17/assets/48244988/6b6aac58-7392-406b-9299-57760340d941)

<br>

### íŒë§¤ì ë¡œì§

![íŒë§¤ì ë¡œì§](https://github.com/pnucse-capstone/capstone-2023-1-17/assets/48244988/092c52d7-e3e9-431e-ae17-b4a884aec510)

<br>

### êµ¬ë§¤ì ë¡œì§

![êµ¬ë§¤ì ë¡œì§](https://github.com/pnucse-capstone/capstone-2023-1-17/assets/48244988/40d202cb-e6f2-47e2-b707-7cf18ce3fc8f)

<br>

## 4. ì†Œê°œ ë° ì‹œì—° ì˜ìƒ

### ì¶”ê°€ ì˜ˆì •

<br>

## 5. í”„ë¡œì íŠ¸ êµ¬ì¡°

```
capstone-2023-1-17
 â”£ ğŸ“‚docs               // ì¡¸ì—…ê³¼ì œ ì œì¶œìš© ë¬¸ì„œ
 â”£ ğŸ“‚FrontEnd           // ì•ˆë“œë¡œì´ë“œ í”„ë¡œì íŠ¸
 â”ƒ â”— ğŸ“‚unity_export    // Unity export ê²½ë¡œ
 â”£ ğŸ“‚Server             // SpringBoot í”„ë¡œì íŠ¸
 â”— ğŸ“‚Unity              // Unity3d í”„ë¡œì íŠ¸
```

<br>

## 6. ì‚¬ìš©ë²•

capstone-2023-1-17 í”„ë¡œì íŠ¸ë¥¼ í´ë¡ í•œë‹¤.

ì´í›„ ë¡œì»¬ ì„œë²„ì™€ í”„ë¡ íŠ¸ì—”ë“œ ë¶€ë¶„ì„ ì‹œí–‰í•œë‹¤.

<br>

<details>
<summary>ì„œë²„</summary>
<div>

### <<í•„ìš” ì†Œí”„íŠ¸ì›¨ì–´>>

Docker and nvidia GPU drivers, capable of working with CUDA 11.8, must be installed.

### <<docker imageë¥¼ ì‚¬ìš©í•´ server+nerfstudio docker container ìƒì„±>>

docker pull jaesubkwon/nerfserver:1.0.1

docker run --gpus all -v C:\d\nerfserver\data:/workspace/ ^
-v C:\d\nerfserver\.cache:/home/user/.cahce/ ^
-p 3389:3389 ^
--name nerfserver -it jaesubkwon/nerfserver:1.0.1

### <<docker imageë¥¼ ì‚¬ìš©í•´ MariaDB docker container ìƒì„±>>

docker pull mariadb

docker run --name mariadb -p 3306:3306 -e MYSQL_ROOT_PASSWORD=root mariadb

### <<docker network container ìƒì„± í›„, í•´ë‹¹ network containerì— 'nerfserver', 'mariadb' containerë¥¼ ì—°ê²°>>

docker network create internalNetwork

docker network connect internalNetwork nerfserver

docker network connect internalNetwork mariadb

### <<MariaDBì— DB ìƒì„± í›„ table ìƒì„±>>

ì´ë¦„ì´ 'nerf' ì¸ DB ìƒì„±.
ì•„ë˜ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•´ 'nerf' DBì— í…Œì´ë¸” 'post', 'meshInfo' ìƒì„±.

```
CREATE TABLE `post` (
    `id`				bigint(20)    NOT NULL AUTO_INCREMENT,
    `userId`			bigint(20)    NOT NULL,
    `title`				varchar(3000) NOT NULL,
    `content`			varchar(3000) NOT NULL,
    `price`				bigint(20)    NOT NULL,
    `date`				datetime	  NOT NULL,
    `numberOfImages`		bigint(20)    NOT NULL,
    `state`				varchar(100) NOT NULL,
    PRIMARY KEY (`id`)
);

CREATE TABLE `meshInfo` (
    `id`		bigint(20)    NOT NULL,
    `xSize`		double,
    `ySize`		double,
    `zSize`		double,
    PRIMARY KEY (`id`)
);
```

### <<ì„œë²„ ì‹¤í–‰ ì¤€ë¹„>>

ì„œë²„íŒŒì¼ ë¹Œë“œ í›„, ìƒì„±ëœ .jar íŒŒì¼ì„ 'nerfserver' containerì˜ /workspace/ ì— ìœ„ì¹˜ì‹œí‚¤ê¸°.
test.sh íŒŒì¼ì„ 'nerfserver' containerì˜ /workspace/ ì— ìœ„ì¹˜ì‹œí‚¤ê¸°.

### <<'nerfserver' containerì—ì„œ .jar íŒŒì¼ì„ í†µí•´ ì„œë²„ ì‹¤í–‰>>

ì˜ˆì‹œ: java -jar server.jar

<br>

</div>
</details>

<details>
<summary>í”„ë¡ íŠ¸ì—”ë“œ</summary>
<div>

### 0. ì˜ì¡´ì„±

**ìœ ë‹ˆí‹°**

- Unity 2022.3.4f1
- Unity XR Plugin Manager 4.4.0
- AR Foundation 5.0.7
- Google ARCore XR Plugin 5.0.7

<br>

**ì•ˆë“œë¡œì´ë“œ**

- minSdk 24
- compileSDK 33
- targetSDK 33
- NDK 25.2.9519653
- Android Gradle plugin 7.4.2
- Volley 1.2.1
- gson 2.10.1

<br>

### 1. Unity ì„¤ì •í•˜ê¸°

- ì„œë²„ ì„¤ì •í•˜ê¸°

  Assets/\_Scripts í´ë”ì˜ connection ìŠ¤í¬ë¦½íŠ¸ì—ì„œ
  URL ë³€ìˆ˜ì— ì„œë²„ì˜ ì£¼ì†Œë¥¼ ì…ë ¥í•œë‹¤.

  ```
  public class Connection : MonoBehaviour
  {
      ...
      private string URL = "http://172.22.61.33:3389";
      ...
  }
  ```

<br>

### 2. Unity í”„ë¡œì íŠ¸ë¥¼ ì•ˆë“œë¡œì´ë“œ í”Œë«í¼ìœ¼ë¡œ export í•˜ê¸°

- ì•ˆë“œë¡œì´ë“œ í”Œë«í¼ìœ¼ë¡œ ë³€ê²½í•˜ê¸°

  Androidë¡œ í”Œë«í¼ì„ ë³€ê²½í•œ í›„, Switch Platformì„ ì„ íƒí•œë‹¤.

<br>

- export í•˜ê¸°

  export ìœ„ì¹˜ëŠ” FrontEndì˜ unity_export í´ë”ë¡œ ì„¤ì •í•œë‹¤.

<br>

### 3. ì•ˆë“œë¡œì´ë“œ ì„¤ì • ë³€ê²½í•˜ê¸°

Gradle íŒŒì¼ì´ ë³€ê²½ë˜ëŠ” ê²½ìš° **Sync Now**ë¥¼ í´ë¦­í•˜ë©° ìµœì‹ í™”í•´ì•¼ í•œë‹¤.

í˜„ì¬ëŠ” ì¡¸ì—…ê³¼ì œ ë°œí‘œë¥¼ ìœ„í•´, ì„œë²„ì— 3ê°œì˜ ì „ì²˜ë¦¬ëœ ê²°ê³¼ë¥¼ ì…ë ¥í•œ í›„ ì‹œì‘í•œë‹¤.

í˜„ì¬ ì‚¬ì§„ì„ ì¶”ê°€í•˜ëŠ” ê¸°ëŠ¥ì€ ë§‰ì•„ë†“ì€ ìƒíƒœì´ë‹¤.

<br>

- **xrmanifest.androidlib ì£¼ì„ì²˜ë¦¬í•˜ê¸°**

  í˜„ì¬ í”„ë¡œì íŠ¸ì˜ **Unity XR Plugin Manager**ê°€ 4.4.0 ë²„ì „ìœ¼ë¡œ ì„¤ì¹˜ë˜ì–´ìˆì–´, export ì‹œ xrmanifest.androidlibê°€ ìƒê¸´ë‹¤. ì´ì „ ë²„ì „ìœ¼ë¡œ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” ê²½ìš°, íŒŒì¼ì´ ì—†ì„ ìˆ˜ ìˆë‹¤.

  ![ì˜ì¡´ì„±](https://github.com/pnucse-capstone/capstone-2023-1-17/assets/48244988/16c6f5cf-00b8-41f8-9fb3-a1b3115406c3)

  ```
  // unityLibrary build.gradle
  dependencies {
      ...
      // implementation project('xrmanifest.androidlib')
  }
  ```

  <br>

- **NDK ê²½ë¡œ ìˆ˜ì •í•˜ê¸°**

  NDKê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´,

  **File - Settings - Appearance & Behavior - System Settings - Android SDK**

  ì—ì„œ NDKë¥¼ ì„¤ì¹˜í•œ í›„,
  android.ndkDirectoryë¥¼ ì„¤ì¹˜ëœ NDK ìœ„ì¹˜ë¡œ ë³€ê²½í•œë‹¤.

  ![ndk](https://github.com/pnucse-capstone/capstone-2023-1-17/assets/48244988/36cb62ac-62d7-4565-8637-0f3d92498e32)

  ìœˆë„ìš° ê¸°ì¤€, ëŒ€ë¶€ë¶„

  **"C:/Program Files/Unity/Hub/Editor/2022.3.4f1/Editor/Data/PlaybackEngines/AndroidPlayer/NDK"**

  ë¡œ ë³€ê²½í•˜ë©´ ëœë‹¤.

  ```
  // unityLibrary build.gradle
  def BuildIl2Cpp(String workingDir, String configuration, String architecture, String abi, String[] staticLibraries) {
      ...
      commandLineArgs.add("--tool-chain-path=" + android.ndkDirectory) // android.ndkDirectory ë³€ê²½
      ...
  }
  ```

  <br>

- **unityLibrary Manifests ìˆ˜ì •í•˜ê¸°**

  intent-filterëŠ” ì•ˆë“œë¡œì´ë“œì˜ ì§„ì…ì ì„ ì˜ë¯¸í•œë‹¤.
  unity ì–´í”Œê³¼ ì•ˆë“œë¡œì´ë“œ ì–´í”Œì´ ê°ê° ì„¤ì¹˜ë˜ê¸°ë¥¼ ì›í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´,
  intent-filterë¥¼ ì‚­ì œí•´ì•¼í•œë‹¤.

  ![ìº¡ì²˜](https://github.com/pnucse-capstone/capstone-2023-1-17/assets/48244988/011cfd9a-d51c-4086-82ab-d1f714704635)

  ```
  <activity android:name="com.unity3d.player.UnityPlayerActivity" android:theme="@style/UnityThemeSelector" android:screenOrientation="fullUser" android:launchMode="singleTask" android:configChanges="mcc|mnc|locale|touchscreen|keyboard|keyboardHidden|navigation|orientation|screenLayout|uiMode|screenSize|smallestScreenSize|fontScale|layoutDirection|density" android:resizeableActivity="false" android:hardwareAccelerated="false" android:exported="true">
    <!-- ì‚­ì œ
    <intent-filter>
      <category android:name="android.intent.category.LAUNCHER" />
      <action android:name="android.intent.action.MAIN" />
    </intent-filter>
    -->
    <meta-data android:name="unityplayer.UnityActivity" android:value="true" />
    <meta-data android:name="notch_support" android:value="true" />
  </activity>
  ```

<br>

### 4. ë¹Œë“œí•˜ê¸°

- ì„œë²„ ì£¼ì†Œ ì…ë ¥í•˜ê¸°

  app/assets/values/string.xmlì— ì„œë²„ ì£¼ì†Œë¥¼ ì…ë ¥í•œë‹¤.

  ![ì„œë²„](https://github.com/pnucse-capstone/capstone-2023-1-17/assets/48244988/8ca4396e-a432-4527-ae72-9e74d77f952c)

í˜„ì¬ëŠ” ë¡œì»¬ ì£¼ì†Œê°€ ì…ë ¥ë˜ì–´ ìˆë‹¤.

  <br>

- ë¹Œë“œí•˜ê¸°

  **Run 'app'**ì„ í†µí•´ ë°”ë¡œ ì‹¤í–‰í•˜ê±°ë‚˜ apk íŒŒì¼ë¡œ ì¶”ì¶œí•˜ì—¬ ì‹¤í–‰í•œë‹¤.

</div>
</details>
